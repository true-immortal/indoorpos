<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Path Tracing with Sensors</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 20px;
        }
        canvas {
            border: 1px solid black;
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>

    <h1>Path Tracing with Sensors</h1>
    <canvas id="canvas" width="400" height="400"></canvas>
    <p id="sensorData">Waiting for sensor data...</p>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const sensorDataElement = document.getElementById('sensorData');

        // Initial position in the middle of the canvas
        let position = { x: canvas.width / 2, y: canvas.height / 2 };
        let lastTimestamp = null;

        // Draw the starting point
        ctx.beginPath();
        ctx.arc(position.x, position.y, 5, 0, 2 * Math.PI);
        ctx.fillStyle = 'red';
        ctx.fill();

        // Listen for device motion events
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (event) => {
                const acceleration = event.accelerationIncludingGravity;
                const timestamp = event.timeStamp;

                if (acceleration && lastTimestamp !== null) {
                    const deltaTime = (timestamp - lastTimestamp) / 1000; // in seconds

                    // Calculate displacement based on acceleration and deltaTime (simplified)
                    const deltaX = acceleration.x * deltaTime * deltaTime * 0.5 * 100; // scaling factor
                    const deltaY = acceleration.y * deltaTime * deltaTime * 0.5 * 100;

                    // Update the position
                    position.x += deltaX;
                    position.y += deltaY;

                    // Ensure the position stays within the canvas
                    position.x = Math.max(0, Math.min(canvas.width, position.x));
                    position.y = Math.max(0, Math.min(canvas.height, position.y));

                    // Draw the path
                    ctx.lineTo(position.x, position.y);
                    ctx.stroke();

                    // Display sensor data
                    sensorDataElement.innerText = `
                        Acceleration X: ${acceleration.x.toFixed(2)} m/s²,
                        Acceleration Y: ${acceleration.y.toFixed(2)} m/s²,
                        Acceleration Z: ${acceleration.z.toFixed(2)} m/s²
                    `;
                }

                lastTimestamp = timestamp;
            });
        } else {
            sensorDataElement.innerText = 'DeviceMotionEvent is not supported on this device/browser.';
        }
    </script>

</body>
</html>
